import{r as p,g as h,a as m,s as f,_ as u,u as C,b as T,j as o,c as j,d as R,e as v,l as Q,f as M,h as X,P,i as B,S as U,T as H,k as A,A as K,m as V,n as Y,o as Z,p as ee,B as te,L as oe,q as ae,t as se}from"./index-UcWu5LRF.js";import{R as ne}from"./router-link-BXxAXos2.js";const le=p.createContext(),q=le;function re(e){return h("MuiTable",e)}m("MuiTable",["root","stickyHeader"]);const ie=["className","component","padding","size","stickyHeader"],ce=e=>{const{classes:t,stickyHeader:a}=e;return R({root:["root",a&&"stickyHeader"]},re,t)},de=f("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.stickyHeader&&t.stickyHeader]}})(({theme:e,ownerState:t})=>u({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":u({},e.typography.body2,{padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"})},t.stickyHeader&&{borderCollapse:"separate"})),I="table",pe=p.forwardRef(function(t,a){const n=C({props:t,name:"MuiTable"}),{className:i,component:s=I,padding:l="normal",size:r="medium",stickyHeader:c=!1}=n,d=T(n,ie),g=u({},n,{component:s,padding:l,size:r,stickyHeader:c}),y=ce(g),z=p.useMemo(()=>({padding:l,size:r,stickyHeader:c}),[l,r,c]);return o.jsx(q.Provider,{value:z,children:o.jsx(de,u({as:s,role:s===I?null:"table",ref:a,className:j(y.root,i),ownerState:g},d))})}),ue=pe,ge=p.createContext(),N=ge;function be(e){return h("MuiTableBody",e)}m("MuiTableBody",["root"]);const xe=["className","component"],ye=e=>{const{classes:t}=e;return R({root:["root"]},be,t)},ve=f("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-row-group"}),he={variant:"body"},W="tbody",me=p.forwardRef(function(t,a){const n=C({props:t,name:"MuiTableBody"}),{className:i,component:s=W}=n,l=T(n,xe),r=u({},n,{component:s}),c=ye(r);return o.jsx(N.Provider,{value:he,children:o.jsx(ve,u({className:j(c.root,i),as:s,ref:a,role:s===W?null:"rowgroup",ownerState:r},l))})}),fe=me;function Ce(e){return h("MuiTableCell",e)}const Te=m("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),je=Te,Re=["align","className","component","padding","scope","size","sortDirection","variant"],$e=e=>{const{classes:t,variant:a,align:n,padding:i,size:s,stickyHeader:l}=e,r={root:["root",a,l&&"stickyHeader",n!=="inherit"&&`align${v(n)}`,i!=="normal"&&`padding${v(i)}`,`size${v(s)}`]};return R(r,Ce,t)},ke=f("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.variant],t[`size${v(a.size)}`],a.padding!=="normal"&&t[`padding${v(a.padding)}`],a.align!=="inherit"&&t[`align${v(a.align)}`],a.stickyHeader&&t.stickyHeader]}})(({theme:e,ownerState:t})=>u({},e.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid
    ${e.palette.mode==="light"?Q(M(e.palette.divider,1),.88):X(M(e.palette.divider,1),.68)}`,textAlign:"left",padding:16},t.variant==="head"&&{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium},t.variant==="body"&&{color:(e.vars||e).palette.text.primary},t.variant==="footer"&&{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)},t.size==="small"&&{padding:"6px 16px",[`&.${je.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}},t.padding==="checkbox"&&{width:48,padding:"0 0 0 4px"},t.padding==="none"&&{padding:0},t.align==="left"&&{textAlign:"left"},t.align==="center"&&{textAlign:"center"},t.align==="right"&&{textAlign:"right",flexDirection:"row-reverse"},t.align==="justify"&&{textAlign:"justify"},t.stickyHeader&&{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default})),we=p.forwardRef(function(t,a){const n=C({props:t,name:"MuiTableCell"}),{align:i="inherit",className:s,component:l,padding:r,scope:c,size:d,sortDirection:g,variant:y}=n,z=T(n,Re),b=p.useContext(q),k=p.useContext(N),_=k&&k.variant==="head";let $;l?$=l:$=_?"th":"td";let w=c;$==="td"?w=void 0:!w&&_&&(w="col");const L=y||k&&k.variant,S=u({},n,{align:i,component:$,padding:r||(b&&b.padding?b.padding:"normal"),size:d||(b&&b.size?b.size:"medium"),sortDirection:g,stickyHeader:L==="head"&&b&&b.stickyHeader,variant:L}),J=$e(S);let O=null;return g&&(O=g==="asc"?"ascending":"descending"),o.jsx(ke,u({as:$,ref:a,className:j(J.root,s),"aria-sort":O,scope:w,ownerState:S},z))}),x=we;function He(e){return h("MuiTableContainer",e)}m("MuiTableContainer",["root"]);const Me=["className","component"],Ne=e=>{const{classes:t}=e;return R({root:["root"]},He,t)},ze=f("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,t)=>t.root})({width:"100%",overflowX:"auto"}),Pe=p.forwardRef(function(t,a){const n=C({props:t,name:"MuiTableContainer"}),{className:i,component:s="div"}=n,l=T(n,Me),r=u({},n,{component:s}),c=Ne(r);return o.jsx(ze,u({ref:a,as:s,className:j(c.root,i),ownerState:r},l))}),Be=Pe;function Ue(e){return h("MuiTableHead",e)}m("MuiTableHead",["root"]);const Ae=["className","component"],_e=e=>{const{classes:t}=e;return R({root:["root"]},Ue,t)},Le=f("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-header-group"}),Se={variant:"head"},D="thead",Oe=p.forwardRef(function(t,a){const n=C({props:t,name:"MuiTableHead"}),{className:i,component:s=D}=n,l=T(n,Ae),r=u({},n,{component:s}),c=_e(r);return o.jsx(N.Provider,{value:Se,children:o.jsx(Le,u({as:s,className:j(c.root,i),ref:a,role:s===D?null:"rowgroup",ownerState:r},l))})}),Ie=Oe;function We(e){return h("MuiTableRow",e)}const De=m("MuiTableRow",["root","selected","hover","head","footer"]),E=De,Ee=["className","component","hover","selected"],Fe=e=>{const{classes:t,selected:a,hover:n,head:i,footer:s}=e;return R({root:["root",a&&"selected",n&&"hover",i&&"head",s&&"footer"]},We,t)},qe=f("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.head&&t.head,a.footer&&t.footer]}})(({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${E.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${E.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:M(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:M(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)}}})),F="tr",Ge=p.forwardRef(function(t,a){const n=C({props:t,name:"MuiTableRow"}),{className:i,component:s=F,hover:l=!1,selected:r=!1}=n,c=T(n,Ee),d=p.useContext(N),g=u({},n,{component:s,hover:l,selected:r,head:d&&d.variant==="head",footer:d&&d.variant==="footer"}),y=Fe(g);return o.jsx(qe,u({as:s,ref:a,className:j(y.root,i),role:s===F?null:"row",ownerState:g},c))}),G=Ge,Je=({id:e,price:t,title:a,previewSrc:n})=>{const i=B(l=>l.products.get(e)??0),s=(l,r)=>{l===1&&!confirm("Удалить товар из корзины?")&&r.preventDefault()};return o.jsxs(G,{children:[o.jsx(x,{align:"center",children:o.jsx(ne,{to:"/products/$productId",params:{productId:e},children:o.jsxs(U,{direction:"row",alignItems:"center",children:[o.jsx("img",{src:n,style:{width:50,height:50,objectFit:"contain"}}),o.jsx(H,{children:a})]})})}),o.jsx(x,{align:"center",children:A(t)}),o.jsx(x,{align:"center",children:o.jsx(K,{productId:e,onDecrement:s})}),o.jsx(x,{align:"center",children:A(t*i)})]})},Qe=p.memo(({products:e})=>o.jsx(Be,{component:P,children:o.jsxs(ue,{children:[o.jsx(Ie,{children:o.jsxs(G,{children:[o.jsx(x,{align:"center",children:"Товар"}),o.jsx(x,{align:"center",children:"Цена"}),o.jsx(x,{align:"center",children:"Количество"}),o.jsx(x,{align:"center",children:"Итог"})]})}),o.jsx(fe,{children:e.map(t=>o.jsx(Je,{...t},t.id))})]})})),Xe=p.memo(()=>{var c;const e=B(d=>d.products),t=B(d=>d.clear),a=V(),n=p.useMemo(()=>Y.getProducts({ids:[...e.keys()]}),[]),i=Z(n),s=(c=i.data)==null?void 0:c.filter(({id:d})=>e.has(d)),l=A(s==null?void 0:s.reduce((d,{price:g,id:y})=>d+g*e.get(y),0)),r=()=>{confirm(`Вы подтверждаете покупку на ${l}`)&&(alert("Спасибо за покупку!"),t(),a({to:"/"}))};return o.jsx(ee,{title:"Корзина",sideSlot:(s==null?void 0:s.length)&&o.jsxs(P,{component:U,p:2,gap:2,children:[o.jsxs(H,{textAlign:"center",children:["Итого: ",l]}),o.jsx(te,{variant:"outlined",onClick:r,children:"Продолжить"})]}),children:o.jsx(oe,{loading:i.isLoading,children:s!=null&&s.length?o.jsx(Qe,{products:s}):o.jsxs(P,{component:U,p:2,justifyContent:"center",height:"100%",gap:2,children:[o.jsx(H,{textAlign:"center",children:"Ваша козина пуста."}),o.jsxs(H,{textAlign:"center",children:["Вернуться в ",o.jsx(ae,{to:"/",children:"каталог"})]})]})})})}),Ye=se("/basket")({component:Xe});export{Ye as Route};
